{"version":3,"sources":["webpack:////Users/hupeng/hupeng/java/yshopb2c-open/yshopmall/yshop-mall-uniapp/pages/shop/ShoppingCart/index.vue?d7e8","webpack:////Users/hupeng/hupeng/java/yshopb2c-open/yshopmall/yshop-mall-uniapp/pages/shop/ShoppingCart/index.vue?42e4","webpack:////Users/hupeng/hupeng/java/yshopb2c-open/yshopmall/yshop-mall-uniapp/pages/shop/ShoppingCart/index.vue?269c","webpack:////Users/hupeng/hupeng/java/yshopb2c-open/yshopmall/yshop-mall-uniapp/pages/shop/ShoppingCart/index.vue?d494","uni-app:///pages/shop/ShoppingCart/index.vue","webpack:////Users/hupeng/hupeng/java/yshopb2c-open/yshopmall/yshop-mall-uniapp/pages/shop/ShoppingCart/index.vue?a478","webpack:////Users/hupeng/hupeng/java/yshopb2c-open/yshopmall/yshop-mall-uniapp/pages/shop/ShoppingCart/index.vue?1550","uni-app:///main.js","webpack:////Users/hupeng/hupeng/java/yshopb2c-open/yshopmall/yshop-mall-uniapp/pages/authorization/index.vue?dfd0","webpack:////Users/hupeng/hupeng/java/yshopb2c-open/yshopmall/yshop-mall-uniapp/pages/authorization/index.vue?3a24","webpack:////Users/hupeng/hupeng/java/yshopb2c-open/yshopmall/yshop-mall-uniapp/pages/authorization/index.vue?c772","webpack:////Users/hupeng/hupeng/java/yshopb2c-open/yshopmall/yshop-mall-uniapp/pages/authorization/index.vue?8c75","uni-app:///pages/authorization/index.vue","webpack:////Users/hupeng/hupeng/java/yshopb2c-open/yshopmall/yshop-mall-uniapp/pages/authorization/index.vue?3bd9","webpack:////Users/hupeng/hupeng/java/yshopb2c-open/yshopmall/yshop-mall-uniapp/pages/authorization/index.vue?48f1"],"names":["name","components","Recommend","Authorization","props","data","cartList","invalid","valid","isH5","validList","isAllSelect","cartCount","countmoney","goodsHidden","footerswitch","count","checkedIds","loaded","computed","onLoad","watch","userInfo","token","onShow","console","methods","goGoodsCon","path","query","id","getCartList","that","delgoods","list","uni","title","icon","duration","gainCount","delInvalidGoods","collectAll","category","placeOrder","manage","goodsOpen","plus","reduce","syncCartNum","then","catch","switchSelect","cart","i","selectnum","cookie","allChecked","carnum","countMoney","carmoney","wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","authorize","canIUseGetUserProfile","code","isChecked","mounted","onHide","onUnload","onChange","goNewsDetail","toLogin","back","getUserInfoBtn","getUserInfoProfile","lang","desc","success","getLoginCode","provider","phoneLoginBefore","phoneLogin","encryptedData","iv","spread","store"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkH;AAClH;AACyD;AACL;AACc;;;AAGlE;AACyN;AACzN,gBAAgB,iNAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,gFAAM;AACR,EAAE,yFAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,oFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACxCA;AAAA;AAAA;AAAA;AAAg3B,CAAgB,myBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;ACyIp4B;AACA;AAIA;AAMA;AAGA;AAIA;AAAA;AAAA;AAAA;EAAA;IAAA;EAAA;AAAA;AAEA;AAAA,eAEA;EACAA;EACAC;IACAC;IACAC;EACA;EACAC;EACAC;IACA;MACAC;QACAC;QACAC;MACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACAC;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACAC;IACA;IACA;IACA;IACA;MACA;IACA;EACA;EACAC;IACAC;MACA;QACA;QACA;QACA;QACA;MACA;IACA;IACAC;MACA;QACA;QACA;QACA;QACA;MACA;IACA;IACAjB;MACA;IACA;EACA;EACAkB;IAIAC;IACA;MACA;MACA;MACA;MACA;IACA;EACA;EACAC;IACAC;MACA;QACAC;QACAC;UACAC;QACA;MACA;IACA;IACAC;MAAA;MACA;MACA;QACAC;QACA;QACA;QACA;UACA;QACA;QACA;UACAA;UACAA;UACAA;UACAA;QACA;QACA;MACA;IACA;IACA;IACAC;MACA;QACAH;QACAtB;QACA0B;MACAA;QACA;UACAJ;QACA;MACA;MACA;QACAK;UACAC;UACAC;UACAC;QACA;QACA;MACA;MACA;QACAJ;UACA,wDACA1B;QACA;QACAwB;QACAA;QACAA;QACAA;QACAA;MACA;IACA;IACA;IACAO;MACA;MACA;QACAP;MACA;IACA;IACA;IACAQ;MACA;QACAV;QACAI;MACAA;QACAJ;MACA;MACA;QACAI;QACAF;QACAA;MACA;IACA;IACA;IACAS;MACA;QACApC;UACAyB;UACAY;QACA;QACAR;MACAA;QACA;UACA7B;UACAA;QACA;MACA;MACA;QACA8B;UACAC;UACAC;UACAC;QACA;QACA;MACA;MACA;QACAH;UACAC;UACAC;UACAC;QACA;MACA;IACA;IACA;IACAK;MACA;QACAT;QACAJ;MACAI;QACA;UACAJ;QACA;MACA;MACA;QACAK;UACAC;UACAC;UACAC;QACA;QACA;MACA;MACA;QACAV;QACAC;UACAC;QACA;MACA;IACA;IACAc;MACA;MACAZ;IACA;IACAa;MACA;MACAb;IACA;IACA;IACAc;MACA;MACA;MACAZ;MACA;QACA;UACAF;QACA;MACA;QACA;UACAA;QACA;MACA;MACAA;MACAA;MACAA;IACA;IACA;IACAe;MACA;MACA;MACA;QACAZ;UACAC;UACAC;UACAC;QACA;QACA;MACA;MACAJ;MACA;QACAF;MACA;MACAA;MACAA;MACAA;IACA;IACAgB;MAAA;MACA;QACA,mEACAC;UACA;UACA;QACA,GACAC;UACA;UACAf;YACAC;YACAC;YACAC;UACA;QACA;MACA;IACA;IACA;IACAa;MACA;QACAC;QACAC;MACAD;MAEA;MACA;QACA;MACA;MACA;MACA;MACA;QACA;UACAE;QACA;MACA;MACAtB;MACAA;MACAA;MACAuB;MACAvB;MACAA;MACAA;IACA;IACA;IACAwB;MACA/B;MACA;MACA;MACAA;MACA;MACA;MACA;MACA;MACA;MACA;MACAO;QACAoB;QACA;UACAnC;QACA;MACA;MACA,iCACAe,cACA;MACAA;MACAA;MACAP;MACA;MACA;MACA;MACA8B;MACAvB;MACAA;MACA;IACA;IACA;IACAyB;MACA;MACA;MACA;MACA;QACA;UACAA;QACA;MACA;MACAzB;IACA;IACA;IACA0B;MACA;MACA;MACA;MACA;QACA;UACAC;QACA;MACA;MACA3B;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACzgBA;AAAA;AAAA;AAAA;AAAmlD,CAAgB,m4CAAG,EAAC,C;;;;;;;;;;;ACAvmD;AACA,OAAO,KAAU,EAAE,kBAKd;;;;;;;;;;;;;;;;ACNL;AAGA;AACA;AAHA;AACA4B,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,cAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkH;AAClH;AACyD;AACL;AACc;;;AAGlE;AACsN;AACtN,gBAAgB,iNAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,gFAAM;AACR,EAAE,yFAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,oFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAi2B,CAAgB,myBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;ACmDr3B;AACA;AACA;AACA;AACA;AACA;AAGA;AAAA;AAAA;AAAA;EAGA3D;IACA;MACA4D;MACAC;MACAC;MACAC;IACA;EACA;EACAjD,4BACA,iEACA;EACAC;IACA;MACA;IACA;IACA;;IAEA;EACA;EACAiD;IACA;EACA;EACAC;IACA;IACA;EACA;EACAC;IACA;IACA;EACA;EACA7C,uDACA,gEACA;IACA8C;MACA/C;MACA;IACA;IACAgD;MACA;QACA7C;QACAC;UAAAC;UAAA9B;QAAA;MACA;IACA;IACA0E;MACA;QACA9C;QACAC;MACA;IACA;IACA8C;MACA;QACA/C;QACAC;MACA;IACA;IACA+C;MAAA;MACAnD;MACAA;MACA;QACAU;UACAC;UACAC;UACAC;QACA;QACA;MACA;MACAH;QACAC;MACA;MACA,oBACAa;QACAd;QACAV;QACA;UACAG;QACA;MACA,GACAsB;QACAf;QACAV;QACAU;UACAC;UACAC;UACAC;QACA;MACA;IACA;IACA;IACAuC;MAAA;MACApD;MACAmC;QACAkB;QACAC;QACAC;UACAvD;UACAU;YACAC;UACA;UACA,uBACAa;YACAxB;YACA;cACAG;YACA;UACA,GACAsB;YACAzB;YACAU;cACAC;cACAC;cACAC;YACA;UACA;QACA;MACA;IACA;IACA2C;MAAA;MACA,0BACAhC;QACA;QACAd;UACA+C;UACAF;YAAA;cAAA;gBAAA;kBAAA;oBAAA;sBACAvD;sBAEA;sBACA;oBAAA;oBAAA;sBAAA;kBAAA;gBAAA;cAAA;YAAA,CACA;YAAA;cAAA;YAAA;YAAA;UAAA;QACA;MACA;IACA;IACA;IACA0D;MACA;QACAhD;UACAC;UACAC;UACAC;QACA;QACA;MACA;IACA;IACA8C;MAAA;MACA;QACA3D;QACA8B;QACA;UACA8B;UACAC;UACAnB;UACAoB;QACA,GACAtC;UACAxB;UACAU;UACAqD;UACAA;UACA,yBACAvC;YACAxB;YACAU;YACAqD;YACA;cACA5D;YACA;UACA,GACAsB;YACAzB;YACA;UACA;QACA,GACAyB;UACAzB;UACAA;UACA;QACA;MACA;QACAU;UACAC;UACAC;UACAC;QACA;MACA;IACA;EAAA;AACA,iCACA;EACA;IACA;IACAb;EACA;AACA;AAAA,2B;;;;;;;;;;;;;AC5PA;AAAA;AAAA;AAAA;AAAwjD,CAAgB,m4CAAG,EAAC,C;;;;;;;;;;;ACA5kD;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/shop/ShoppingCart/index.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=1ab7afca&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/shop/ShoppingCart/index.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=1ab7afca&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 =\n    _vm.$store.getters.token || _vm.userInfo.uid\n      ? _vm.cartList.valid.length\n      : null\n  var g1 =\n    _vm.$store.getters.token || _vm.userInfo.uid\n      ? _vm.validList.length > 0 || _vm.cartList.invalid.length > 0\n      : null\n  var g2 =\n    (_vm.$store.getters.token || _vm.userInfo.uid) && g1\n      ? _vm.cartList.invalid.length\n      : null\n  var g3 =\n    _vm.$store.getters.token || _vm.userInfo.uid\n      ? _vm.cartList.valid.length === 0 && _vm.cartList.invalid.length === 0\n      : null\n  var g4 =\n    _vm.$store.getters.token || _vm.userInfo.uid\n      ? _vm.cartList.valid.length\n      : null\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        g1: g1,\n        g2: g2,\n        g3: g3,\n        g4: g4,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"","<template>\r\n  <view class=\"shoppingCart\">\r\n    <view v-if=\"$store.getters.token||userInfo.uid\">\r\n      <view class=\"labelNav acea-row row-around row-middle\">\r\n        <view class=\"item\">\r\n          <text class=\"iconfont icon-xuanzhong\"></text>100%正品保证\r\n        </view>\r\n        <view class=\"item\">\r\n          <text class=\"iconfont icon-xuanzhong\"></text>所有商品精挑细选\r\n        </view>\r\n        <view class=\"item\">\r\n          <text class=\"iconfont icon-xuanzhong\"></text>售后无忧\r\n        </view>\r\n      </view>\r\n      <view class=\"nav acea-row row-between-wrapper\">\r\n        <view>\r\n          购物数量\r\n          <text class=\"num font-color-red\">{{ count }}</text>\r\n        </view>\r\n        <view v-if=\"cartList.valid.length > 0\" class=\"administrate acea-row row-center-wrapper\" @click=\"manage\">\r\n          {{ footerswitch ? '取消' : '管理' }}</view>\r\n      </view>\r\n      <view v-if=\"validList.length > 0 || cartList.invalid.length > 0\">\r\n        <view class=\"list\">\r\n          <view class=\"item acea-row row-between-wrapper\" v-for=\"(item, cartListValidIndex) in validList\"\r\n            :key=\"cartListValidIndex\">\r\n            <view class=\"select-btn\">\r\n              <view class=\"checkbox-wrapper\">\r\n                <checkbox-group @change=\"switchSelect(cartListValidIndex)\">\r\n                  <label class=\"well-check\">\r\n                    <checkbox color=\"#eb3729\" value :checked=\"item.checked\"></checkbox>\r\n                  </label>\r\n                </checkbox-group>\r\n              </view>\r\n            </view>\r\n            <view class=\"picTxt acea-row row-between-wrapper\">\r\n              <view class=\"pictrue\" @click=\"goGoodsCon(item)\">\r\n                <image :src=\"item.productInfo.attrInfo.image\" v-if=\"item.productInfo.attrInfo\" />\r\n                <image :src=\"item.productInfo.image\" v-else />\r\n              </view>\r\n              <view class=\"text\">\r\n                <view class=\"line1\">{{ item.productInfo.storeName }}</view>\r\n                <view class=\"infor line1\" v-if=\"item.productInfo.attrInfo\">属性：{{ item.productInfo.attrInfo.sku }}</view>\r\n                <view class=\"money\">￥{{ item.truePrice }}</view>\r\n              </view>\r\n              <view class=\"carnum acea-row row-center-wrapper\">\r\n                <view class=\"reduce\" :class=\"validList[cartListValidIndex].cartNum <= 1 ? 'on' : ''\"\r\n                  @click.prevent=\"reduce(cartListValidIndex)\">-</view>\r\n                <view class=\"num\">{{ item.cartNum }}</view>\r\n                <view class=\"plus\" v-if=\"validList[cartListValidIndex].attrInfo\"\r\n                  :class=\"validList[cartListValidIndex].cartNum >= validList[cartListValidIndex].attrInfo.stock ? 'on' : ''\"\r\n                  @click.prevent=\"plus(cartListValidIndex)\">+</view>\r\n                <view class=\"plus\" v-else\r\n                  :class=\"validList[cartListValidIndex].cartNum >= validList[cartListValidIndex].stock ? 'on' : ''\"\r\n                  @click.prevent=\"plus(cartListValidIndex)\">+</view>\r\n              </view>\r\n            </view>\r\n          </view>\r\n        </view>\r\n        <view class=\"invalidGoods\" v-if=\"cartList.invalid.length > 0\">\r\n          <view class=\"goodsNav acea-row row-between-wrapper\">\r\n            <view @click=\"goodsOpen\">\r\n              <text class=\"iconfont\" :class=\"goodsHidden === true ? 'icon-xiangyou' : 'icon-xiangxia'\"></text>失效商品\r\n            </view>\r\n            <view class=\"del\" @click=\"delInvalidGoods\">\r\n              <text class=\"iconfont icon-shanchu1\"></text>清空\r\n            </view>\r\n          </view>\r\n          <view class=\"goodsList\" :hidden=\"goodsHidden\">\r\n            <view v-for=\"(item, cartListinvalidIndex) in cartList.invalid\" :key=\"cartListinvalidIndex\">\r\n              <view @click=\"goGoodsCon(item)\" class=\"item acea-row row-between-wrapper\" v-if=\"item.productInfo\">\r\n                <view class=\"invalid acea-row row-center-wrapper\">失效</view>\r\n                <view class=\"pictrue\">\r\n                  <image :src=\"item.productInfo.attrInfo.image\" v-if=\"item.productInfo.attrInfo\" />\r\n                  <image :src=\"item.productInfo.image\" v-else />\r\n                </view>\r\n                <view class=\"text acea-row row-column-between\">\r\n                  <view class=\"line1\">{{ item.productInfo.storeName }}</view>\r\n                  <view class=\"infor line1\" v-if=\"item.productInfo.attrInfo\">属性：{{ item.productInfo.attrInfo.sku }}\r\n                  </view>\r\n                  <view class=\"acea-row row-between-wrapper\">\r\n                    <view class=\"end\">该商品已下架</view>\r\n                  </view>\r\n                </view>\r\n              </view>\r\n            </view>\r\n          </view>\r\n        </view>\r\n      </view>\r\n      <!--购物车暂无商品-->\r\n      <view class=\"noCart\" v-if=\"cartList.valid.length === 0 && cartList.invalid.length === 0\">\r\n        <view class=\"pictrue\">\r\n          <image :src=\"`${$VUE_APP_RESOURCES_URL}/images/noCart.png`\" />\r\n        </view>\r\n        <Recommend></Recommend>\r\n      </view>\r\n      <view style=\"height:210rpx\"></view>\r\n      <view :class=\"{'footer acea-row row-between-wrapper':true,'footer-h5':isH5}\" v-if=\"cartList.valid.length > 0\">\r\n        <view>\r\n          <view class=\"select-btn\">\r\n            <view class=\"checkbox-wrapper\">\r\n              <!-- <label class=\"well-check\">\r\n              <input\r\n                type=\"checkbox\"\r\n                name\r\n                value\r\n                :checked=\"isAllSelect && cartCount > 0\"\r\n                @click=\"allChecked\"\r\n              />\r\n              <i class=\"icon\"></i>\r\n              <text class=\"checkAll\">全选 ({{ cartCount }})</text>\r\n              </label>-->\r\n\r\n              <checkbox-group @change=\"allChecked\">\r\n                <label class=\"well-check\">\r\n                  <checkbox color=\"#eb3729\" value=\"allSelect\" :checked=\"isAllSelect && cartCount > 0\"></checkbox>\r\n                  <text class=\"checkAll\">全选 ({{ cartCount }})</text>\r\n                </label>\r\n              </checkbox-group>\r\n            </view>\r\n          </view>\r\n        </view>\r\n        <view class=\"money acea-row row-middle\" v-if=\"footerswitch === false\">\r\n          <text class=\"font-color-red\">￥{{ countmoney }}</text>\r\n          <view class=\"placeOrder bg-color-red\" @click=\"placeOrder\">立即下单</view>\r\n        </view>\r\n        <view class=\"button acea-row row-middle\" v-else>\r\n          <!-- <view class=\"bnt cart-color\" @click=\"collectAll\">收藏</view> -->\r\n          <view class=\"bnt\" @click=\"delgoods\">删除</view>\r\n        </view>\r\n      </view>\r\n    </view>\r\n    <Authorization v-else ref=\"authorization\" />\r\n  </view>\r\n</template>\r\n<script>\r\n  import Recommend from \"@/components/Recommend\";\r\n  import Authorization from \"@/pages/authorization/index\";\r\n  import {\r\n    mapGetters\r\n  } from \"vuex\";\r\n\r\n  import {\r\n    getCartList,\r\n    postCartDel,\r\n    changeCartNum,\r\n    getCartCount\r\n  } from \"@/api/store\";\r\n  import {\r\n    postCollectAll\r\n  } from \"@/api/user\";\r\n  import {\r\n    mul,\r\n    add\r\n  } from \"@/utils/bc\";\r\n  import cookie from \"@/utils/store/cookie\";\r\n\r\n  const CHECKED_IDS = \"cart_checked\";\r\n\r\n  export default {\r\n    name: \"ShoppingCart\",\r\n    components: {\r\n      Recommend,\r\n      Authorization\r\n    },\r\n    props: {},\r\n    data: function () {\r\n      return {\r\n        cartList: {\r\n          invalid: [],\r\n          valid: []\r\n        },\r\n        isH5: false,\r\n        validList: [],\r\n        isAllSelect: false,\r\n        cartCount: 0,\r\n        countmoney: 0,\r\n        goodsHidden: true,\r\n        footerswitch: false,\r\n        count: 0,\r\n        checkedIds: [],\r\n        loaded: false\r\n      };\r\n    },\r\n    computed: mapGetters([\"userInfo\", \"token\"]),\r\n    //   watch: {\r\n    //     $yroute(n) {\r\n    //       if (n.name === \"ShoppingCart\") {\r\n    //         this.carnum();\r\n    //         this.countMoney();\r\n    //         this.getCartList();\r\n    //         this.gainCount();\r\n    //         this.goodsHidden = true;\r\n    //         this.footerswitch = false;\r\n    //       }\r\n    //     },\r\n    //     cartList(list) {\r\n    //       this.validList = list.valid;\r\n    //     }\r\n    //   },\n\tonLoad() {\n\t  // if (wx.getUserProfile) {\n\t  //   this.canIUseGetUserProfile = true\n\t  // }\n\t  if (!this.$store.getters.token && !this.userInfo.uid) {\n\t    this.$refs.authorization.getLoginCode()\n\t  }\n\t},\r\n    watch: {\r\n      userInfo(user) {\r\n        if (user.uid) {\r\n          this.carnum();\r\n          this.countMoney();\r\n          this.getCartList();\r\n          this.gainCount();\r\n        }\r\n      },\r\n      token(token) {\r\n        if (this.userInfo.uid) {\r\n          this.carnum();\r\n          this.countMoney();\r\n          this.getCartList();\r\n          this.gainCount();\r\n        }\r\n      },\r\n      cartList(list) {\r\n        this.validList = list.valid;\r\n      }\r\n    },\r\n    onShow: function () {\r\n      // #ifdef H5\r\n      this.isH5 = true\r\n      // #endif\r\n      console.log(this.userInfo)\r\n      if (this.userInfo.uid) {\r\n        this.carnum();\r\n        this.countMoney();\r\n        this.getCartList();\r\n        this.gainCount();\r\n      }\r\n    },\r\n    methods: {\r\n      goGoodsCon(item) {\r\n        this.$yrouter.push({\r\n          path: \"/pages/shop/GoodsCon/index\",\r\n          query: {\r\n            id: item.productId\r\n          }\r\n        });\r\n      },\r\n      getCartList: function () {\r\n        let that = this;\r\n        getCartList().then(res => {\r\n          that.cartList = res.data;\r\n          let checkedIds = cookie.get(CHECKED_IDS) || [];\r\n          if (!Array.isArray(checkedIds)) checkedIds = [];\r\n          this.cartList.valid.forEach(cart => {\r\n            if (checkedIds.indexOf(cart.id) !== -1) cart.checked = true;\r\n          });\r\n          if (checkedIds.length) {\r\n            that.checkedIds = checkedIds;\r\n            that.isAllSelect = checkedIds.length === this.cartList.valid.length;\r\n            that.carnum();\r\n            that.countMoney();\r\n          }\r\n          this.loaded = true;\r\n        });\r\n      },\r\n      //删除商品；\r\n      delgoods: function () {\r\n        let that = this,\r\n          id = [],\r\n          valid = [],\r\n          list = that.cartList.valid;\r\n        list.forEach(function (val) {\r\n          if (val.checked === true) {\r\n            id.push(val.id);\r\n          }\r\n        });\r\n        if (id.length === 0) {\r\n          uni.showToast({\r\n            title: \"请选择产品\",\r\n            icon: \"none\",\r\n            duration: 2000\r\n          });\r\n          return;\r\n        }\r\n        postCartDel(id).then(function () {\r\n          list.forEach(function (val, i) {\r\n            if (val.checked === false || val.checked === undefined)\r\n              valid.push(list[i]);\r\n          });\r\n          that.$set(that.cartList, \"valid\", valid);\r\n          that.carnum();\r\n          that.countMoney();\r\n          that.gainCount();\r\n          that.getCartList();\r\n        });\r\n      },\r\n      // //获取数量\r\n      gainCount: function () {\r\n        let that = this;\r\n        getCartCount().then(res => {\r\n          that.count = res.data.count;\r\n        });\r\n      },\r\n      //清除失效产品；\r\n      delInvalidGoods: function () {\r\n        let that = this,\r\n          id = [],\r\n          list = that.cartList.invalid;\r\n        list.forEach(function (val) {\r\n          id.push(val.id);\r\n        });\r\n        postCartDel(id).then(function () {\r\n          list.splice(0, list.length);\r\n          that.gainCount();\r\n          that.getCartList();\r\n        });\r\n      },\r\n      //批量收藏;\r\n      collectAll: function () {\r\n        let that = this,\r\n          data = {\r\n            id: [],\r\n            category: \"\"\r\n          },\r\n          list = that.cartList.valid;\r\n        list.forEach(function (val) {\r\n          if (val.checked === true) {\r\n            data.id.push(val.product_id);\r\n            data.category = val.type;\r\n          }\r\n        });\r\n        if (data.id.length === 0) {\r\n          uni.showToast({\r\n            title: \"请选择产品\",\r\n            icon: \"none\",\r\n            duration: 2000\r\n          });\r\n          return;\r\n        }\r\n        postCollectAll(data).then(function () {\r\n          uni.showToast({\r\n            title: \"收藏成功!\",\r\n            icon: \"none\",\r\n            duration: 2000\r\n          });\r\n        });\r\n      },\r\n      //立即下单；\r\n      placeOrder: function () {\r\n        let that = this,\r\n          list = that.cartList.valid,\r\n          id = [];\r\n        list.forEach(function (val) {\r\n          if (val.checked === true) {\r\n            id.push(val.id);\r\n          }\r\n        });\r\n        if (id.length === 0) {\r\n          uni.showToast({\r\n            title: \"请选择产品\",\r\n            icon: \"none\",\r\n            duration: 2000\r\n          });\r\n          return;\r\n        }\r\n        this.$yrouter.push({\r\n          path: \"/pages/order/OrderSubmission/index\",\r\n          query: {\r\n            id: id.join(\",\")\r\n          }\r\n        });\r\n      },\r\n      manage: function () {\r\n        let that = this;\r\n        that.footerswitch = !that.footerswitch;\r\n      },\r\n      goodsOpen: function () {\r\n        let that = this;\r\n        that.goodsHidden = !that.goodsHidden;\r\n      },\r\n      //加\r\n      plus: function (index) {\r\n        let that = this;\r\n        let list = that.cartList.valid[index];\r\n        list.cartNum++;\r\n        if (list.attrInfo) {\r\n          if (list.cartNum >= list.attrInfo.stock) {\r\n            that.$set(list, \"cart_num\", list.attrInfo.stock);\r\n          }\r\n        } else {\r\n          if (list.cartNum >= list.stock) {\r\n            that.$set(list, \"cart_num\", list.stock);\r\n          }\r\n        }\r\n        that.carnum();\r\n        that.countMoney();\r\n        that.syncCartNum(list);\r\n      },\r\n      //减\r\n      reduce: function (index) {\r\n        let that = this;\r\n        let list = that.cartList.valid[index];\r\n        if (list.cartNum <= 1) {\r\n          uni.showToast({\r\n            title: \"已经是底线啦!\",\r\n            icon: \"none\",\r\n            duration: 2000\r\n          });\r\n          return;\r\n        }\r\n        list.cartNum--;\r\n        if (list.cartNum < 1) {\r\n          that.$set(list, \"cart_num\", 1);\r\n        }\r\n        that.carnum();\r\n        that.countMoney();\r\n        that.syncCartNum(list);\r\n      },\r\n      syncCartNum(cart) {\r\n        if (!cart.sync) {\r\n          changeCartNum(cart.id, Math.max(cart.cartNum, 1) || 1)\r\n            .then(res => {\r\n              this.getCartList();\r\n              this.gainCount();\r\n            })\r\n            .catch(error => {\r\n              this.gainCount();\r\n              uni.showToast({\r\n                title: error.response.data.msg,\r\n                icon: \"none\",\r\n                duration: 2000\r\n              });\r\n            });\r\n        }\r\n      },\r\n      //单选\r\n      switchSelect: function (index) {\r\n        let that = this,\r\n          cart = that.cartList.valid[index],\r\n          i = this.checkedIds.indexOf(cart.id);\r\n        cart.checked = !cart.checked;\r\n\r\n        if (i !== -1) this.checkedIds.splice(i, 1);\r\n        if (cart.checked) {\r\n          this.checkedIds.push(cart.id);\r\n        }\r\n        let len = that.cartList.valid.length;\r\n        let selectnum = [];\r\n        for (let i = 0; i < len; i++) {\r\n          if (that.cartList.valid[i].checked === true) {\r\n            selectnum.push(true);\r\n          }\r\n        }\r\n        that.isAllSelect = selectnum.length === len;\r\n        that.$set(that, \"cartList\", that.cartList);\r\n        that.$set(that, \"isAllSelect\", that.isAllSelect);\r\n        cookie.set(CHECKED_IDS, that.checkedIds);\r\n        that.carnum();\r\n        that.gainCount();\r\n        that.countMoney();\r\n      },\r\n      //全选\r\n      allChecked: function (e) {\r\n        console.log(e);\r\n        let that = this;\r\n        let selectAllStatus = e.mp.detail.value[0] == \"allSelect\" ? true : false;\r\n        console.log(selectAllStatus);\r\n        // let selectAllStatus = that.isAllSelect;\r\n        let checkedIds = [];\r\n        // for (let i = 0; i < array.length; i++) {\r\n        //   array[i].checked = selectAllStatus;\r\n        //   checked.push()\r\n        // }\r\n        that.cartList.valid.forEach(cart => {\r\n          cart.checked = selectAllStatus;\r\n          if (selectAllStatus) {\r\n            checkedIds.push(cart.id);\r\n          }\r\n        });\r\n        let cartList = {\r\n          ...that.cartList\r\n        };\r\n        that.cartList = [];\r\n        that.cartList = cartList;\r\n        console.log(this.cartList);\r\n        this.$set(this, \"cartList\", this.cartList);\r\n        this.$set(this, \"isAllSelect\", selectAllStatus);\r\n        this.checkedIds = checkedIds;\r\n        cookie.set(CHECKED_IDS, checkedIds);\r\n        that.carnum();\r\n        that.countMoney();\r\n        this.$forceUpdate();\r\n      },\r\n      //数量\r\n      carnum: function () {\r\n        let that = this;\r\n        var carnum = 0;\r\n        var array = that.cartList.valid;\r\n        for (let i = 0; i < array.length; i++) {\r\n          if (array[i].checked === true) {\r\n            carnum += parseInt(array[i].cartNum);\r\n          }\r\n        }\r\n        that.$set(that, \"cartCount\", carnum);\r\n      },\r\n      //总共价钱；\r\n      countMoney: function () {\r\n        let that = this;\r\n        let carmoney = 0;\r\n        let array = that.cartList.valid;\r\n        for (let i = 0; i < array.length; i++) {\r\n          if (array[i].checked === true) {\r\n            carmoney = add(carmoney, mul(array[i].cartNum, array[i].truePrice));\r\n          }\r\n        }\r\n        that.countmoney = carmoney;\r\n      }\r\n    }\r\n  };\r\n</script>\r\n\r\n<style lang=\"less\">\r\n  .footer-h5 {\r\n    bottom: 50px\r\n  }\r\n  .shoppingCart{\r\n\t  position: relative;\r\n\t  .list{\r\n\t\t  margin-top: 150rpx;\r\n\t\t  padding-top: 15rpx;\r\n\t  }\r\n  }\r\n</style>\r\n","import mod from \"-!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-2!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-5!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=less&\"; export default mod; export * from \"-!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-2!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-5!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=less&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1743735226711\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  ","import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/shop/ShoppingCart/index.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=7ba8a2d3&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/authorization/index.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=7ba8a2d3&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"","<template>\r\n  <view class=\"container\">\r\n    <!-- #ifdef MP-WEIXIN -->\r\n    <view\r\n      v-if=\"!token\"\r\n      class=\"force-login-wrap\"\r\n    >\r\n      <view class=\"force-login__content y-f\">\n\t\t<image src=\"@/static/120x120.png\" style=\"width: 100rpx; height: 100rpx;border-radius: 100rpx;\"></image>\r\n        <view class=\"login-notice\">YSHOP电商系统</view>\r\n        <button\r\n          class=\"cu-btn author-btn\"\r\n          open-type=\"getPhoneNumber\"\r\n          @getphonenumber=\"phoneLogin\"\n\t\t  v-if=\"isChecked\"\r\n        >手机号快捷登录</button>\n\t\t<button\n\t\t  v-else\n\t\t  class=\"cu-btn author-btn\"\n\t\t  @tap=\"phoneLoginBefore\"\n\t\t>手机号快捷登录</button>\r\n        <button\r\n          class=\"cu-btn close-btn\"\r\n          @tap=\"toLogin\"\r\n        >其他手机登录</button>\r\n      </view>\r\n    </view>\n\t<view class=\"hint\">\n\t\t<radio  :checked=\"isChecked\" @tap.stop=\"onChange\" />\n\t\t我已经阅读并遵守\n\t\t<text class=\"link\" @tap=\"goNewsDetail(50,'用户协议')\">《用户协议》</text>与\n\t\t\t<text class=\"link\"  @tap=\"goNewsDetail(49,'隐私政策')\">《隐私政策》</text>\n\t\t\t<!--上面协议是固定的 请添加相应id文章-->\n\t</view>\r\n    <!-- #endif -->\r\n    <!-- #ifndef MP-WEIXIN -->\r\n    <view class=\"force-login-wrap\">\r\n      <!-- <image class=\"logo-bg\" :src=\"`${$VUE_APP_RESOURCES_URL}/images/logo_bg.png`\" mode=\"aspectFill\"></image> -->\r\n      <view class=\"force-login__content y-f\">\r\n        <view class=\"login-notice\">为了提供更优质的服务，请先登录</view>\r\n        <button\r\n          class=\"cu-btn author-btn\"\r\n          @tap=\"toLogin\"\r\n        >去登录</button>\r\n      </view>\r\n    </view>\r\n    <!-- #endif -->\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nimport { mapState, mapMutations, mapActions } from 'vuex'\r\nimport { wxappAuth, getUser, getUserInfo } from '@/api/user'\r\nimport { login, authorize, getProvider } from '@/utils'\r\nimport dayjs from 'dayjs'\r\nimport cookie from '@/utils/store/cookie'\r\nimport store from '@/store'\r\n\r\n// 公众号登录\r\nimport { auth } from '@/libs/wechat.js'\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      authorize: false,\r\n      canIUseGetUserProfile: false,\r\n      code: '',\n\t  isChecked: false\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapState(['isAuthorization', '$deviceType', 'token']),\r\n  },\r\n  onLoad() {\r\n    if (wx.getUserProfile) {\r\n      this.canIUseGetUserProfile = true\r\n    }\r\n    this.getLoginCode()\r\n\r\n    // // 先校验用户是否授权，如果没有授权，显示授权按钮\r\n  },\r\n  mounted() {\r\n    this.getLoginCode()\r\n  },\r\n  onHide() {\r\n    this.updateAuthorizationPage(false)\r\n    this.changeAuthorization(false)\r\n  },\r\n  onUnload() {\r\n    this.updateAuthorizationPage(false)\r\n    this.changeAuthorization(false)\r\n  },\r\n  methods: {\r\n    ...mapActions(['changeAuthorization', 'setUserInfo']),\r\n    ...mapMutations(['updateAuthorizationPage']),\n\tonChange() {\n\t\tconsole.log('isChecked;',this.isChecked)\n\t\tthis.isChecked = !this.isChecked\n\t},\n\tgoNewsDetail(id,name) {\n\t  this.$yrouter.push({\n\t    path: \"/pages/shop/news/NewsDetail/index\",\n\t    query: { id: id,name:name }\n\t  });\n\t},\r\n    toLogin() {\r\n      this.$yrouter.push({\r\n        path: '/pages/user/Login/index',\r\n        query: {},\r\n      })\r\n    },\r\n    back() {\r\n      this.$yrouter.switchTab({\r\n        path: '/pages/home/index',\r\n        query: {},\r\n      })\r\n    },\r\n    getUserInfoBtn(data) {\r\n      console.log(data)\r\n      console.log('getUserInfoBtn')\r\n      if (data.detail.errMsg == 'getUserInfo:fail auth deny') {\r\n        uni.showToast({\r\n          title: '取消授权',\r\n          icon: 'none',\r\n          duration: 2000,\r\n        })\r\n        return\r\n      }\r\n      uni.showLoading({\r\n        title: '登录中',\r\n      })\r\n      login()\r\n        .then(e => {\r\n          uni.hideLoading()\r\n          console.log('重定向')\r\n          this.$yrouter.reLaunch({\r\n            path: cookie.get('redirect').replace(/\\ /g, ''),\r\n          })\r\n        })\r\n        .catch(error => {\r\n          uni.hideLoading()\r\n          console.log(error)\r\n          uni.showToast({\r\n            title: error,\r\n            icon: 'none',\r\n            duration: 2000,\r\n          })\r\n        })\r\n    },\r\n    // 申请获取用户信息\r\n    getUserInfoProfile(data) {\r\n      console.log('getUserInfoProfile')\r\n      wx.getUserProfile({\r\n        lang: 'zh_CN',\r\n        desc: '需要获取您的信息用来展示',\r\n        success: res => {\r\n          console.log('用户信息', res)\r\n          uni.showLoading({\r\n            title: '登录中',\r\n          })\r\n          login(res)\r\n            .then(e => {\r\n              console.log('重定向')\r\n              this.$yrouter.reLaunch({\r\n                path: cookie.get('redirect').replace(/\\ /g, ''),\r\n              })\r\n            })\r\n            .catch(error => {\r\n              console.log(error)\r\n              uni.showToast({\r\n                title: error,\r\n                icon: 'none',\r\n                duration: 2000,\r\n              })\r\n            })\r\n        },\r\n      })\r\n    },\r\n    getLoginCode() {\r\n      getProvider()\r\n        .then(provider => {\r\n          // uni登录\r\n          uni.login({\r\n            provider: provider,\r\n            success: async loginRes => {\r\n              console.log(\"🚀 ~ file: index.vue:171 ~ getLoginCode ~ loginRes:\", loginRes)\n\t\t\t  \r\n              this.code = loginRes.code\n\t\t\t  //console.log('code11:',this.code)\r\n            }\r\n          })\r\n        })\r\n    },\r\n    // 微信用户手机号登录\n\tphoneLoginBefore() {\n\t\tif(!this.isChecked) {  \n\t\t\t  uni.showToast({\n\t\t\t\ttitle: '请勾选下面协议',\n\t\t\t\ticon: 'none',\n\t\t\t\tduration: 2000,\n\t\t\t  })\n\t\t\t  return\n\t\t}\n\t},\r\n    phoneLogin(e) {\r\n      if (e.mp.detail.errMsg == 'getPhoneNumber:ok') {\r\n        console.log('wxLoginCode', this.code)\r\n        cookie.set('wxLoginCode', this.code)\r\n        wxappAuth({\r\n          encryptedData: e.mp.detail.encryptedData,\r\n          iv: e.mp.detail.iv,\r\n          code: this.code,\r\n          spread: cookie.get('spread'),\r\n        })\r\n          .then(res => {\r\n            console.log('登录成功,开始处理登录信息保存，并获取用户详情')\r\n            uni.hideLoading()\r\n            store.commit('login', res.data.token, dayjs(res.data.expires_time))\r\n            store.dispatch('userInfo', true)\r\n            getUserInfo()\r\n              .then(user => {\r\n                console.log('获取用户信息成功')\r\n                uni.setStorageSync('uid', user.data.uid)\r\n                store.dispatch('setUserInfo', user.data)\r\n                this.$yrouter.reLaunch({\r\n                  path: cookie.get('redirect').replace(/\\ /g, ''),\r\n                })\r\n              })\r\n              .catch(error => {\r\n                console.log('获取用户信息失败')\r\n                this.getLoginCode()\r\n              })\r\n          })\r\n          .catch(error => {\r\n            console.log(error)\r\n            console.log('登录接口调用失败')\r\n            this.getLoginCode()\r\n          })\r\n      } else {\r\n        uni.showToast({\r\n          title: '已拒绝授权',\r\n          icon: 'none',\r\n          duration: 2000,\r\n        })\r\n      }\r\n    },\r\n  },\r\n  mounted() {\r\n    if (wx.getUserProfile) {\r\n      this.canIUseGetUserProfile = true\r\n      console.log(this.canIUseGetUserProfile)\r\n    }\r\n  },\r\n}\r\n</script>\r\n\r\n<style lang=\"less\">\n.hint {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tpadding: 20rpx 40rpx;\n\tfont-size: 25rpx;\n\tcolor: #000;\n\t\n\t.link {\n\t\tcolor: #ff8e3c;\n\t}\n}\r\n.container {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: flex-start;\r\n  position: relative;\r\n}\r\n\r\n.force-login-wrap {\r\n  width: 100%;\r\n  height: 100%;\r\n  overflow: hidden;\r\n  z-index: 11111;\r\n  top: 0;\r\n\r\n  .logo-bg {\r\n    width: 640rpx;\r\n    height: 300rpx;\r\n  }\r\n\r\n  .force-login__content {\r\n    position: absolute;\r\n    left: 50%;\r\n    top: 50%;\r\n    transform: translate(-50%, -50%);\r\n\r\n    .user-avatar {\r\n      width: 160rpx;\r\n      height: 160rpx;\r\n      border-radius: 50%;\r\n      overflow: hidden;\r\n      margin-bottom: 40rpx;\r\n    }\r\n\r\n    .user-name {\r\n      font-size: 35rpx;\r\n      font-family: PingFang SC;\r\n      font-weight: bold;\r\n      color: #000;\r\n      margin-bottom: 30rpx;\r\n    }\r\n\r\n    .login-notice {\r\n      font-size: 28rpx;\r\n      font-family: PingFang SC;\r\n      font-weight: 400;\r\n      color: #000;\r\n      line-height: 44rpx;\r\n      width: 500rpx;\r\n      text-align: center;\r\n      margin-bottom: 80rpx;\r\n    }\r\n\r\n    .author-btn {\r\n      width: 630rpx;\r\n      height: 80rpx;\r\n      background: linear-gradient(to right, #f35447 0%, #ff8e3c 100%);\r\n      background: -moz-linear-gradient(to right, #f35447 0%, #ff8e3c 100%);\r\n      // box-shadow: 0px 7rpx 6rpx 0px rgba(229, 138, 0, 0.22);\r\n      border-radius: 40rpx;\r\n      font-size: 30rpx;\r\n      font-family: PingFang SC;\r\n      font-weight: 500;\r\n      color: rgba(255, 255, 255, 1);\r\n    }\r\n\r\n    .close-btn {\r\n      width: 630rpx;\r\n      height: 80rpx;\r\n      margin-top: 30rpx;\r\n      border-radius: 40rpx;\r\n      border: 2rpx solid #eb3729;\r\n      background: none;\r\n      font-size: 30rpx;\r\n      font-family: PingFang SC;\r\n      font-weight: 500;\r\n      color: #eb3729;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-2!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-5!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=less&\"; export default mod; export * from \"-!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-2!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-5!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=less&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1743735223922\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}